@model ProfileViewModel
@{
    ViewData["Title"] = "My Profile";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <!-- Success Message -->
            @if (TempData["SuccessMessage"] != null)
            {
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    @TempData["SuccessMessage"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            }

            <!-- Lit Web Component: Profile Card -->
            <profile-card first-name="@Model.FirstName"
                          last-name="@Model.LastName"
                          belt="@Model.Belt.ToString()"
                          email="@Model.Email"
                          phone-number="@Model.PhoneNumber"
                          member-since="@Model.CreatedAt.ToString("yyyy-MM-dd")"
                          last-login="@(Model.LastLoginAt?.ToString("yyyy-MM-dd") ?? "Never")">
            </profile-card>
        </div>
    </div>
</div>

<!-- Import and configure Lit components -->
<script type="module">
   
    // Wait for DOM to be ready
    document.addEventListener('DOMContentLoaded', () => {
        const profileCard = document.getElementById('profileCard');

        // Handle events from the web component
        profileCard.addEventListener('edit-profile', () => {
            window.location.href = '@Url.Action("Edit", "Profile")';
        });

        profileCard.addEventListener('change-password', () => {
            window.location.href = '@Url.Action("ChangePassword", "Profile")';
        });
    });
</script>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}